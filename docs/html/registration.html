

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Registration &mdash; valis &#34;1.0.0rc11&#34;
 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Slide I/O" href="slide_io.html" />
    <link rel="prev" title="VALIS" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: black" >
          

          
            <a href="index.html">
          

          
            
            <img src="_static/valis_logo_black_no_bg.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Registration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-valis.registration">Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#valis">Valis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#slide">Slide</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="slide_io.html">Slide I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="preprocessing.html">Image pre-processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="feature_detectors.html">Feature detectors and descriptors</a></li>
<li class="toctree-l1"><a class="reference internal" href="feature_matcher.html">Feature matching</a></li>
<li class="toctree-l1"><a class="reference internal" href="affine_optimizer.html">Affine optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="non_rigid_registrars.html">Non-rigid registration</a></li>
<li class="toctree-l1"><a class="reference internal" href="serial_rigid.html">Serial rigid registration</a></li>
<li class="toctree-l1"><a class="reference internal" href="serial_non_rigid.html">Serial non-rigid registration</a></li>
<li class="toctree-l1"><a class="reference internal" href="viz.html">Visualization</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">valis</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Registration</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/registration.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="registration">
<h1>Registration<a class="headerlink" href="#registration" title="Permalink to this headline">¶</a></h1>
<section id="module-valis.registration">
<span id="functions"></span><h2>Functions<a class="headerlink" href="#module-valis.registration" title="Permalink to this headline">¶</a></h2>
<p>Classes and functions to register a collection of images</p>
<dl class="py function">
<dt class="sig sig-object py" id="valis.registration.init_jvm">
<span class="sig-prename descclassname"><span class="pre">valis.registration.</span></span><span class="sig-name descname"><span class="pre">init_jvm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mem_gb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/valis/registration.html#init_jvm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#valis.registration.init_jvm" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize JVM for BioFormats</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="valis.registration.kill_jvm">
<span class="sig-prename descclassname"><span class="pre">valis.registration.</span></span><span class="sig-name descname"><span class="pre">kill_jvm</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/valis/registration.html#kill_jvm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#valis.registration.kill_jvm" title="Permalink to this definition">¶</a></dt>
<dd><p>Kill JVM for BioFormats</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="valis.registration.load_registrar">
<span class="sig-prename descclassname"><span class="pre">valis.registration.</span></span><span class="sig-name descname"><span class="pre">load_registrar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src_f</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/valis/registration.html#load_registrar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#valis.registration.load_registrar" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a Valis object</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>src_f</strong> (<em>string</em>) – Path to pickled Valis object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>registrar</strong> – Valis object used for registration</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#valis.registration.Valis" title="valis.registration.Valis">Valis</a></p>
</dd>
</dl>
</dd></dl>

<section id="valis">
<h3>Valis<a class="headerlink" href="#valis" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="valis.registration.Valis">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">valis.registration.</span></span><span class="sig-name descname"><span class="pre">Valis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dst_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">series=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_type=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_detector_cls=&lt;class</span> <span class="pre">'valis.feature_detectors.VggFD'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformer_cls=&lt;class</span> <span class="pre">'skimage.transform._geometric.SimilarityTransform'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">affine_optimizer_cls=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">similarity_metric='n_matches'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match_filter_method='RANSAC'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imgs_ordered=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_rigid_registrar_cls=&lt;class</span> <span class="pre">'valis.non_rigid_registrars.OpticalFlowWarper'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_rigid_reg_params={}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compose_non_rigid=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_list=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_img_f=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align_to_reference=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_rigid=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">create_masks=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution_xyu=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slide_dims_dict_wh=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_image_dim_px=850</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_processed_image_dim_px=850</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_non_rigid_registartion_dim_px=850</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thumbnail_size=500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_method='img_stats'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qt_emitter=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/valis/registration.html#Valis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#valis.registration.Valis" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads, registers, and saves a series of slides/images</p>
<p>Implements the registration pipeline described in
“VALIS: Virtual Alignment of pathoLogy Image Series” by Gatenbee et al.
This pipeline will read images and whole slide images (WSI) using pyvips,
bioformats, or openslide, and so should work with a wide variety of formats.
VALIS can perform both rigid and non-rigid registration. The registered slides
can be saved as ome.tiff slides that can be used in downstream analyses. The
ome.tiff format is opensource and widely supported, being readable in several
different programming languages (Python, Java, Matlab, etc…) and software,
such as QuPath or HALO.</p>
<p>The pipeline is fully automated and goes as follows:</p>
<p>1. Images/slides are converted to numpy arrays. As WSI are often
too large to fit into memory, these images are usually lower resolution
images from different pyramid levels.</p>
<p>2. Images are processed to single channel images. They are then
normalized to make them look as similar as possible.</p>
<ol class="arabic simple" start="3">
<li><p>Image features are detected and then matched between all pairs of image.</p></li>
</ol>
<p>4. If the order of images is unknown, they will be optimally ordered
based on their feature similarity</p>
<p>5. Rigid registration is performed serially, with each image being
rigidly aligned to the previous image in the stack.</p>
<p>6. Non-rigid registration is then performed either by 1) aliging each image
towards the center of the stack, composing the deformation fields
along the way, or 2) using groupwise registration that non-rigidly aligns
the images to a common frame of reference.</p>
<p>7. Error is measured by calculating the distance between registered
matched features.</p>
<p>The transformations found by VALIS can then be used to warp the full
resolution slides. It is also possible to merge non-RGB registered slides
to create a highly multiplexed image. These aligned and/or merged slides
can then be saved as ome.tiff images using pyvips.</p>
<p>In addition to warping images and slides, VALIS can also warp point data,
such as cell centoids or ROI coordinates.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Valis.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#valis.registration.Valis.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Descriptive name of registrar, such as the sample’s name.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Valis.src_dir">
<span class="sig-name descname"><span class="pre">src_dir</span></span><a class="headerlink" href="#valis.registration.Valis.src_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Path to directory containing the slides that will be registered.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Valis.dst_dir">
<span class="sig-name descname"><span class="pre">dst_dir</span></span><a class="headerlink" href="#valis.registration.Valis.dst_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Path to where the results should be saved.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Valis.original_img_list">
<span class="sig-name descname"><span class="pre">original_img_list</span></span><a class="headerlink" href="#valis.registration.Valis.original_img_list" title="Permalink to this definition">¶</a></dt>
<dd><p>List of images converted from the slides in <cite>src_dir</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Valis.slide_dims_dict_wh">
<span class="sig-name descname"><span class="pre">slide_dims_dict_wh</span></span><a class="headerlink" href="#valis.registration.Valis.slide_dims_dict_wh" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of slide dimensions. Only needed if dimensions not
available in the slide/image’s metadata.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Valis.resolution_xyu">
<span class="sig-name descname"><span class="pre">resolution_xyu</span></span><a class="headerlink" href="#valis.registration.Valis.resolution_xyu" title="Permalink to this definition">¶</a></dt>
<dd><p>Physical size per pixel and the unit.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Valis.image_type">
<span class="sig-name descname"><span class="pre">image_type</span></span><a class="headerlink" href="#valis.registration.Valis.image_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Type of image, i.e. “brightfield” or “fluorescence”</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Valis.series">
<span class="sig-name descname"><span class="pre">series</span></span><a class="headerlink" href="#valis.registration.Valis.series" title="Permalink to this definition">¶</a></dt>
<dd><p>Slide series to that was read.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Valis.size">
<span class="sig-name descname"><span class="pre">size</span></span><a class="headerlink" href="#valis.registration.Valis.size" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of images to align</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Valis.aligned_img_shape_rc">
<span class="sig-name descname"><span class="pre">aligned_img_shape_rc</span></span><a class="headerlink" href="#valis.registration.Valis.aligned_img_shape_rc" title="Permalink to this definition">¶</a></dt>
<dd><p>Shape (row, col) of aligned images</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>tuple of int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Valis.aligned_slide_shape_rc">
<span class="sig-name descname"><span class="pre">aligned_slide_shape_rc</span></span><a class="headerlink" href="#valis.registration.Valis.aligned_slide_shape_rc" title="Permalink to this definition">¶</a></dt>
<dd><p>Shape (row, col) of the aligned slides</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>tuple of int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Valis.slide_dict">
<span class="sig-name descname"><span class="pre">slide_dict</span></span><a class="headerlink" href="#valis.registration.Valis.slide_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of Slide objects, each of which contains information
about a slide, and methods to warp it.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict of Slide</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Valis.brightfield_procsseing_fxn_str">
<span class="sig-name descname"><span class="pre">brightfield_procsseing_fxn_str</span></span><a class="headerlink" href="#valis.registration.Valis.brightfield_procsseing_fxn_str" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of function used to process brightfield images.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Valis.if_procsseing_fxn_str">
<span class="sig-name descname"><span class="pre">if_procsseing_fxn_str</span></span><a class="headerlink" href="#valis.registration.Valis.if_procsseing_fxn_str" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of function used to process fluorescence images.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Valis.max_image_dim_px">
<span class="sig-name descname"><span class="pre">max_image_dim_px</span></span><a class="headerlink" href="#valis.registration.Valis.max_image_dim_px" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum width or height of images that will be saved.
This limit is mostly to keep memory in check.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Valis.max_processed_image_dim_px">
<span class="sig-name descname"><span class="pre">max_processed_image_dim_px</span></span><a class="headerlink" href="#valis.registration.Valis.max_processed_image_dim_px" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum width or height of processed images. An important
parameter, as it determines the size of of the image in which
features will be detected and displacement fields computed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Valis.reference_img_f">
<span class="sig-name descname"><span class="pre">reference_img_f</span></span><a class="headerlink" href="#valis.registration.Valis.reference_img_f" title="Permalink to this definition">¶</a></dt>
<dd><p>Filename of image that will be treated as the center of the stack.
If None, the index of the middle image will be the reference.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Valis.reference_img_idx">
<span class="sig-name descname"><span class="pre">reference_img_idx</span></span><a class="headerlink" href="#valis.registration.Valis.reference_img_idx" title="Permalink to this definition">¶</a></dt>
<dd><p>Index of slide that corresponds to <cite>reference_img_f</cite>, after
the <cite>img_obj_list</cite> has been sorted during rigid registration.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Valis.align_to_reference">
<span class="sig-name descname"><span class="pre">align_to_reference</span></span><a class="headerlink" href="#valis.registration.Valis.align_to_reference" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether or not images should be aligne to a reference image
specified by <cite>reference_img_f</cite>. Will be set to True if
<cite>reference_img_f</cite> is provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Valis.crop">
<span class="sig-name descname"><span class="pre">crop</span></span><a class="headerlink" href="#valis.registration.Valis.crop" title="Permalink to this definition">¶</a></dt>
<dd><p>How to crop the registered images.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a>, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Valis.rigid_registrar">
<span class="sig-name descname"><span class="pre">rigid_registrar</span></span><a class="headerlink" href="#valis.registration.Valis.rigid_registrar" title="Permalink to this definition">¶</a></dt>
<dd><p>SerialRigidRegistrar object that performs the rigid registration.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="serial_rigid.html#valis.serial_rigid.SerialRigidRegistrar" title="valis.serial_rigid.SerialRigidRegistrar">SerialRigidRegistrar</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Valis.rigid_reg_kwargs">
<span class="sig-name descname"><span class="pre">rigid_reg_kwargs</span></span><a class="headerlink" href="#valis.registration.Valis.rigid_reg_kwargs" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of keyward arguments passed to
<cite>serial_rigid.register_images</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Valis.feature_descriptor_str">
<span class="sig-name descname"><span class="pre">feature_descriptor_str</span></span><a class="headerlink" href="#valis.registration.Valis.feature_descriptor_str" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of feature descriptor.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Valis.feature_detector_str">
<span class="sig-name descname"><span class="pre">feature_detector_str</span></span><a class="headerlink" href="#valis.registration.Valis.feature_detector_str" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of feature detector.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Valis.transform_str">
<span class="sig-name descname"><span class="pre">transform_str</span></span><a class="headerlink" href="#valis.registration.Valis.transform_str" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of rigid transform</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Valis.similarity_metric">
<span class="sig-name descname"><span class="pre">similarity_metric</span></span><a class="headerlink" href="#valis.registration.Valis.similarity_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of similarity metric used to order slides.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Valis.match_filter_method">
<span class="sig-name descname"><span class="pre">match_filter_method</span></span><a class="headerlink" href="#valis.registration.Valis.match_filter_method" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of method used to filter out poor feature matches.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Valis.non_rigid_registrar">
<span class="sig-name descname"><span class="pre">non_rigid_registrar</span></span><a class="headerlink" href="#valis.registration.Valis.non_rigid_registrar" title="Permalink to this definition">¶</a></dt>
<dd><p>SerialNonRigidRegistrar object that performs serial
non-rigid registration.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="serial_non_rigid.html#valis.serial_non_rigid.SerialNonRigidRegistrar" title="valis.serial_non_rigid.SerialNonRigidRegistrar">SerialNonRigidRegistrar</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Valis.non_rigid_reg_kwargs">
<span class="sig-name descname"><span class="pre">non_rigid_reg_kwargs</span></span><a class="headerlink" href="#valis.registration.Valis.non_rigid_reg_kwargs" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of keyward arguments passed to
<cite>serial_non_rigid.register_images</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Valis.non_rigid_registrar_cls">
<span class="sig-name descname"><span class="pre">non_rigid_registrar_cls</span></span><a class="headerlink" href="#valis.registration.Valis.non_rigid_registrar_cls" title="Permalink to this definition">¶</a></dt>
<dd><p>Uninstantiated NonRigidRegistrar class that will be used
by <cite>non_rigid_registrar</cite> to calculate the deformation fields
between images.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="non_rigid_registrars.html#valis.non_rigid_registrars.NonRigidRegistrar" title="valis.non_rigid_registrars.NonRigidRegistrar">NonRigidRegistrar</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Valis.non_rigid_reg_class_str">
<span class="sig-name descname"><span class="pre">non_rigid_reg_class_str</span></span><a class="headerlink" href="#valis.registration.Valis.non_rigid_reg_class_str" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the of class <cite>non_rigid_registrar_cls</cite> belongs to.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Valis.thumbnail_size">
<span class="sig-name descname"><span class="pre">thumbnail_size</span></span><a class="headerlink" href="#valis.registration.Valis.thumbnail_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum width or height of thumbnails that show results</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Valis.original_overlap_img">
<span class="sig-name descname"><span class="pre">original_overlap_img</span></span><a class="headerlink" href="#valis.registration.Valis.original_overlap_img" title="Permalink to this definition">¶</a></dt>
<dd><p>Image showing how original images overlap before registration.
Created by merging coloring the inverted greyscale copies of each
image, and then merging those images.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Valis.rigid_overlap_img">
<span class="sig-name descname"><span class="pre">rigid_overlap_img</span></span><a class="headerlink" href="#valis.registration.Valis.rigid_overlap_img" title="Permalink to this definition">¶</a></dt>
<dd><p>Image showing how images overlap after rigid registration.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Valis.non_rigid_overlap_img">
<span class="sig-name descname"><span class="pre">non_rigid_overlap_img</span></span><a class="headerlink" href="#valis.registration.Valis.non_rigid_overlap_img" title="Permalink to this definition">¶</a></dt>
<dd><p>Image showing how images overlap after rigid + non-rigid registration.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Valis.has_rounds">
<span class="sig-name descname"><span class="pre">has_rounds</span></span><a class="headerlink" href="#valis.registration.Valis.has_rounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether or not the contents of <cite>src_dir</cite> contain subdirectories that
have single images spread across multiple files. An example would be
.ndpis images.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Valis.norm_method">
<span class="sig-name descname"><span class="pre">norm_method</span></span><a class="headerlink" href="#valis.registration.Valis.norm_method" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of method used to normalize the processed images</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Valis.target_processing_stats">
<span class="sig-name descname"><span class="pre">target_processing_stats</span></span><a class="headerlink" href="#valis.registration.Valis.target_processing_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Array of processed images’ stats used to normalize all images</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Valis.summary_df">
<span class="sig-name descname"><span class="pre">summary_df</span></span><a class="headerlink" href="#valis.registration.Valis.summary_df" title="Permalink to this definition">¶</a></dt>
<dd><p>Pandas dataframe containing information about the results, such
as the error, shape of aligned slides, time to completion, etc…</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>pd.Dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Valis.start_time">
<span class="sig-name descname"><span class="pre">start_time</span></span><a class="headerlink" href="#valis.registration.Valis.start_time" title="Permalink to this definition">¶</a></dt>
<dd><p>The time at which registation was initiated.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Valis.end_rigid_time">
<span class="sig-name descname"><span class="pre">end_rigid_time</span></span><a class="headerlink" href="#valis.registration.Valis.end_rigid_time" title="Permalink to this definition">¶</a></dt>
<dd><p>The time at which rigid registation was completed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Valis.end_non_rigid_time">
<span class="sig-name descname"><span class="pre">end_non_rigid_time</span></span><a class="headerlink" href="#valis.registration.Valis.end_non_rigid_time" title="Permalink to this definition">¶</a></dt>
<dd><p>The time at which non-rigid registation was completed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Valis.qt_emitter">
<span class="sig-name descname"><span class="pre">qt_emitter</span></span><a class="headerlink" href="#valis.registration.Valis.qt_emitter" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to emit signals that update the GUI’s progress bars</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>PySide2.QtCore.Signal</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Examples</p>
<p>Basic example using default parameters</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">valis</span> <span class="kn">import</span> <span class="n">registration</span><span class="p">,</span> <span class="n">data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">slide_src_dir</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dcis_src_dir</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results_dst_dir</span> <span class="o">=</span> <span class="s2">&quot;./slide_registration_example&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">registered_slide_dst_dir</span> <span class="o">=</span> <span class="s2">&quot;./slide_registration_example/registered_slides&quot;</span>
</pre></div>
</div>
<p>Perform registration</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rigid_registrar</span><span class="p">,</span> <span class="n">non_rigid_registrar</span><span class="p">,</span> <span class="n">error_df</span> <span class="o">=</span> <span class="n">registrar</span><span class="o">.</span><span class="n">register</span><span class="p">()</span>
</pre></div>
</div>
<p>View results in “./slide_registration_example”.
If they look good, warp and save the slides as ome.tiff</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">registrar</span><span class="o">.</span><span class="n">warp_and_save_slides</span><span class="p">(</span><span class="n">registered_slide_dst_dir</span><span class="p">)</span>
</pre></div>
</div>
<p>This example shows how to register CyCIF images and then merge
to create a high dimensional ome.tiff slide</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">registrar</span> <span class="o">=</span> <span class="n">registration</span><span class="o">.</span><span class="n">Valis</span><span class="p">(</span><span class="n">slide_src_dir</span><span class="p">,</span> <span class="n">results_dst_dir</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rigid_registrar</span><span class="p">,</span> <span class="n">non_rigid_registrar</span><span class="p">,</span> <span class="n">error_df</span> <span class="o">=</span> <span class="n">registrar</span><span class="o">.</span><span class="n">register</span><span class="p">()</span>
</pre></div>
</div>
<p>Create function to get marker names from each slides’ filename</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">cnames_from_filename</span><span class="p">(</span><span class="n">src_f</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">f</span> <span class="o">=</span> <span class="n">valtils</span><span class="o">.</span><span class="n">get_name</span><span class="p">(</span><span class="n">src_f</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;DAPI&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">f</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel_name_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">f</span><span class="p">:</span><span class="n">cnames_from_filename</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span>  <span class="n">registrar</span><span class="o">.</span><span class="n">original_img_list</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">merged_img</span><span class="p">,</span> <span class="n">channel_names</span><span class="p">,</span> <span class="n">ome_xml</span> <span class="o">=</span> <span class="n">registrar</span><span class="o">.</span><span class="n">warp_and_merge_slides</span><span class="p">(</span><span class="n">merged_slide_dst_f</span><span class="p">,</span> <span class="n">channel_name_dict</span><span class="o">=</span><span class="n">channel_name_dict</span><span class="p">)</span>
</pre></div>
</div>
<p>View ome.tiff, located at merged_slide_dst_f</p>
<dl class="py method">
<dt class="sig sig-object py" id="valis.registration.Valis.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dst_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">series=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_type=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_detector_cls=&lt;class</span> <span class="pre">'valis.feature_detectors.VggFD'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformer_cls=&lt;class</span> <span class="pre">'skimage.transform._geometric.SimilarityTransform'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">affine_optimizer_cls=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">similarity_metric='n_matches'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match_filter_method='RANSAC'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imgs_ordered=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_rigid_registrar_cls=&lt;class</span> <span class="pre">'valis.non_rigid_registrars.OpticalFlowWarper'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_rigid_reg_params={}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compose_non_rigid=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_list=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_img_f=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align_to_reference=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_rigid=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">create_masks=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution_xyu=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slide_dims_dict_wh=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_image_dim_px=850</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_processed_image_dim_px=850</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_non_rigid_registartion_dim_px=850</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thumbnail_size=500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_method='img_stats'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qt_emitter=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/valis/registration.html#Valis.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#valis.registration.Valis.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl>
<dt>src_dir: str</dt><dd><p>Path to directory containing the slides that will be registered.</p>
</dd>
<dt>dst_dir<span class="classifier">str</span></dt><dd><p>Path to where the results should be saved.</p>
</dd>
<dt>name<span class="classifier">str, optional</span></dt><dd><p>Descriptive name of registrar, such as the sample’s name</p>
</dd>
<dt>series<span class="classifier">int, optional</span></dt><dd><p>Slide series to that was read. If None, series will be set to 0.</p>
</dd>
<dt>img_type<span class="classifier">str, optional</span></dt><dd><p>The type of image, either “brightfield”, “fluorescence”,
or “multi”. If None, VALIS will guess <cite>img_type</cite>
of each image, based on the number of channels and datatype.
Will assume that RGB = “brightfield”,
otherwise <cite>img_type</cite> will be set to “fluorescence”.</p>
</dd>
<dt>feature_detector_cls<span class="classifier">FeatureDD, optional</span></dt><dd><p>Uninstantiated FeatureDD object that detects and computes
image features. Default is VggFD. The
available feature_detectors are found in the <cite>feature_detectors</cite>
module. If a desired feature detector is not available,
one can be created by subclassing <cite>feature_detectors.FeatureDD</cite>.</p>
</dd>
<dt>transformer_cls<span class="classifier">scikit-image Transform class, optional</span></dt><dd><p>Uninstantiated scikit-image transformer used to find
transformation matrix that will warp each image to the target
image. Default is SimilarityTransform</p>
</dd>
<dt>affine_optimizer_cls<span class="classifier">AffineOptimzer class, optional</span></dt><dd><p>Uninstantiated AffineOptimzer that will minimize a
cost function to find the optimal affine transformations.
If a desired affine optimization is not available,
one can be created by subclassing <cite>affine_optimizer.AffineOptimizer</cite>.</p>
</dd>
<dt>similarity_metric<span class="classifier">str, optional</span></dt><dd><p>Metric used to calculate similarity between images, which is in
turn used to build the distance matrix used to sort the images.
Can be “n_matches”, or a string to used as
distance in spatial.distance.cdist. “n_matches”
is the number of matching features between image pairs.</p>
</dd>
<dt>match_filter_method: str, optional</dt><dd><p>“GMS” will use filter_matches_gms() to remove poor matches.
This uses the Grid-based Motion Statistics (GMS) or RANSAC.</p>
</dd>
<dt>imgs_ordered<span class="classifier">bool, optional</span></dt><dd><p>Boolean defining whether or not the order of images in img_dir
are already in the correct order. If True, then each filename should
begin with the number that indicates its position in the z-stack. If
False, then the images will be sorted by ordering a feature distance
matix. Default is False.</p>
</dd>
<dt>reference_img_f<span class="classifier">str, optional</span></dt><dd><p>Filename of image that will be treated as the center of the stack.
If None, the index of the middle image will be the reference.</p>
</dd>
<dt>align_to_reference<span class="classifier">bool, optional</span></dt><dd><p>If <cite>False</cite>, images will be non-rigidly aligned serially towards the
reference image. If <cite>True</cite>, images will be non-rigidly aligned
directly to the reference image. If <cite>reference_img_f</cite> is None,
then the reference image will be the one in the middle of the stack.</p>
</dd>
<dt>non_rigid_registrar_cls<span class="classifier">NonRigidRegistrar, optional</span></dt><dd><p>Uninstantiated NonRigidRegistrar class that will be used to
calculate the deformation fields between images. See
the <cite>non_rigid_registrars</cite> module for a desciption of available
methods. If a desired non-rigid registration method is not available,
one can be implemented by subclassing.NonRigidRegistrar.
If None, then only rigid registration will be performed</p>
</dd>
<dt>non_rigid_reg_params: dictionary, optional</dt><dd><p>Dictionary containing key, value pairs to be used to initialize
<cite>non_rigid_registrar_cls</cite>.
In the case where simple ITK is used by the, params should be
a SimpleITK.ParameterMap. Note that numeric values nedd to be
converted to strings. See the NonRigidRegistrar classes in
<cite>non_rigid_registrars</cite> for the available non-rigid registration
methods and arguments.</p>
</dd>
<dt>compose_non_rigid<span class="classifier">bool, optional</span></dt><dd><p>Whether or not to compose non-rigid transformations. If <cite>True</cite>,
then an image is non-rigidly warped before aligning to the
adjacent non-rigidly aligned image. This allows the transformations
to accumulate, which may bring distant features together but could
also  result  in un-wanted deformations, particularly around the edges.
If <cite>False</cite>, the image not warped before being aaligned to the adjacent
non-rigidly aligned image. This can reduce unwanted deformations, but
may not bring distant features together.</p>
</dd>
<dt>do_rigid: bool, dictionary, optional</dt><dd><p>Whether or not to perform rigid registration. If <cite>False</cite>, rigid
registration will be skipped.</p>
<p>If <cite>do_rigid</cite> is a dictionary, it should contain inverse transformation
matrices to rigidly align images to the specificed by <cite>reference_img_f</cite>.
M will be estimated for images that are not in the dictionary.
Each key is the filename of the image associated with the transformation matrix,
and value is a dictionary containing the following values:</p>
<blockquote>
<div><dl class="simple">
<dt><cite>M</cite><span class="classifier">(required) a 3x3 inverse transformation matrix as a numpy array.</span></dt><dd><p>Found by determining how to align fixed to moving.
If <cite>M</cite> was found by determining how to align moving to fixed,
then <cite>M</cite> will need to be inverted first.</p>
</dd>
<dt><cite>transformation_src_shape_rc</cite><span class="classifier">(optional) shape (row, col) of image used to find the rigid transformation.</span></dt><dd><p>If not provided, then it is assumed to be the shape of the level 0 slide</p>
</dd>
<dt><cite>transformation_dst_shape_rc</cite><span class="classifier">(optional) shape of registered image.</span></dt><dd><p>If not provided, this is assumed to be the shape of the level 0 reference slide.</p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>crop: str, optional</dt><dd><p>How to crop the registered images. “overlap” will crop to include
only areas where all images overlapped. “reference” crops to the
area that overlaps with a reference image, defined by
<cite>reference_img_f</cite>. This option can be used even if <cite>reference_img_f</cite>
is <cite>None</cite> because the reference image will be set as the one at the center
of the stack.</p>
<p>If both <cite>crop</cite> and <cite>reference_img_f</cite> are <cite>None</cite>, <cite>crop</cite>
will be set to “overlap”. If <cite>crop</cite> is None, but <cite>reference_img_f</cite>
is defined, then <cite>crop</cite> will be set to “reference”.</p>
</dd>
<dt>create_masks<span class="classifier">bool, optional</span></dt><dd><p>Whether or not to create and apply masks for registration.
Can help focus alignment on the tissue, but can sometimes
mask too much if there is a lot of variation in the image.</p>
</dd>
<dt>resolution_xyu: tuple, optional</dt><dd><p>Physical size per pixel and the unit. If None (the default), these
values will be determined for each slide using the slides’ metadata.
If provided, this physical pixel sizes will be used for all of the slides.
This option is available in case one cannot easily access to the original
slides, but does have the information on pixel’s physical units.</p>
</dd>
<dt>slide_dims_dict_wh<span class="classifier">dict, optional</span></dt><dd><p>Key= slide/image file name,
value= dimensions = [(width, height), (width, height), …] for each level.
If None (the default), the slide dimensions will be pulled from the
slides’ metadata. If provided, those values will be overwritten. This
option is available in case one cannot easily access to the original
slides, but does have the information on the slide dimensions.</p>
</dd>
<dt>max_image_dim_px<span class="classifier">int, optional</span></dt><dd><p>Maximum width or height of images that will be saved.
This limit is mostly to keep memory in check.</p>
</dd>
<dt>max_processed_image_dim_px<span class="classifier">int, optional</span></dt><dd><p>Maximum width or height of processed images. An important
parameter, as it determines the size of of the image in which
features will be detected and displacement fields computed.</p>
</dd>
<dt>max_non_rigid_registartion_dim_px<span class="classifier">int, optional</span></dt><dd><p>Maximum width or height of images used for non-rigid registration.
Larger values may yeild more accurate results, at the expense of
speed and memory. There is also a practical limit, as the specified
size may be too large to fit in memory.</p>
</dd>
<dt>mask_dict<span class="classifier">dictionary</span></dt><dd><p>Dictionary where key = overlap type (all, overlap, or reference), and
value = (mask, mask_bbox_xywh)</p>
</dd>
<dt>thumbnail_size<span class="classifier">int, optional</span></dt><dd><p>Maximum width or height of thumbnails that show results</p>
</dd>
<dt>norm_method<span class="classifier">str</span></dt><dd><p>Name of method used to normalize the processed images. Options
are “histo_match” for histogram matching, “img_stats” for normalizing by
image statistics. See preprocessing.match_histograms
and preprocessing.norm_khan for details.</p>
</dd>
<dt>_non_rigid_bbox<span class="classifier">list</span></dt><dd><p>Bounding box of area in which non-rigid registration was conducted</p>
</dd>
<dt>_full_displacement_shape_rc<span class="classifier">tuple</span></dt><dd><p>Shape of full displacement field. Would be larger than <cite>_non_rigid_bbox</cite>
if non-rigid registration only performed in a masked region</p>
</dd>
<dt>qt_emitter<span class="classifier">PySide2.QtCore.Signal, optional</span></dt><dd><p>Used to emit signals that update the GUI’s progress bars</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="valis.registration.Valis.get_slide">
<span class="sig-name descname"><span class="pre">get_slide</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src_f</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/valis/registration.html#Valis.get_slide"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#valis.registration.Valis.get_slide" title="Permalink to this definition">¶</a></dt>
<dd><p>Get Slide</p>
<p>Get the Slide associated with <cite>src_f</cite>.
Slide store registration parameters and other metadata about
the slide associated with <cite>src_f</cite>. Slide can also:</p>
<ul class="simple">
<li><p>Convert the slide to a numpy array (Slide.slide2image)</p></li>
<li><p>Convert the slide to a pyvips.Image (Slide.slide2vips)</p></li>
<li><p>Warp the slide (Slide.warp_slide)</p></li>
<li><p>Save the warped slide as an ome.tiff (Slide.warp_and_save_slide)</p></li>
<li><p>Warp an image of the slide (Slide.warp_img)</p></li>
<li><p>Warp points (Slide.warp_xy)</p></li>
<li><p>Warp points in one slide to their position in another unwarped slide (Slide.warp_xy_from_to)</p></li>
<li><p>Access slide ome-xml (Slide.original_xml)</p></li>
</ul>
<p>See Slide for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>src_f</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Path to the slide</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>slide_obj</strong> – Slide associated with src_f</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#valis.registration.Slide" title="valis.registration.Slide">Slide</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="valis.registration.Valis.register">
<span class="sig-name descname"><span class="pre">register</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">brightfield_processing_cls=&lt;class</span> <span class="pre">'valis.preprocessing.ColorfulStandardizer'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">brightfield_processing_kwargs={'c':</span> <span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'h':</span> <span class="pre">0}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">if_processing_cls=&lt;class</span> <span class="pre">'valis.preprocessing.ChannelGetter'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">if_processing_kwargs={'adaptive_eq':</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'channel':</span> <span class="pre">'dapi'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reader_cls=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/valis/registration.html#Valis.register"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#valis.registration.Valis.register" title="Permalink to this definition">¶</a></dt>
<dd><p>Register a collection of images</p>
<p>This function will convert the slides to images, pre-process and normalize them, and
then conduct rigid registration. Non-rigid registration will then be performed if the
<cite>non_rigid_registrar_cls</cite> argument used to initialize the Valis object was not None.</p>
<p>In addition to the objects returned, the desination directory (i.e. <cite>dst_dir</cite>)
will contain thumbnails so that one can visualize the results: converted image
thumbnails will be in “images/”; processed images in “processed/”;
rigidly aligned images in “rigid_registration/”; non-rigidly aligned images in “non_rigid_registration/”;
non-rigid deformation field images (i.e. warped grids colored by the direction and magntidue)
of the deformation) will be in “”deformation_fields/”. The size of these thumbnails
is determined by the <cite>thumbnail_size</cite> argument used to initialze this object.</p>
<p>One can get a sense of how well the registration worked by looking
in the “overlaps/”, which shows how the images overlap before
registration, after rigid registration, and after non-rigid registration. Each image
is created by coloring an inverted greyscale version of the processed images, and then
blending those images.</p>
<p>The “data/” directory will contain a pickled copy of this registrar, which can be
later be opened (unpickled) and used to warp slides and/or point data.</p>
<p>“data/” will also contain the <cite>summary_df</cite> saved as a csv file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>brightfield_processing_cls</strong> (<a class="reference internal" href="preprocessing.html#valis.preprocessing.ImageProcesser" title="valis.preprocessing.ImageProcesser"><em>preprocessing.ImageProcesser</em></a>) – preprocessing.ImageProcesser used to pre-process brightfield images to make
them look as similar as possible.</p></li>
<li><p><strong>brightfield_processing_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><em>dict</em></a>) – Dictionary of keyward arguments to be passed to <cite>brightfield_processing_cls</cite></p></li>
<li><p><strong>if_processing_cls</strong> (<a class="reference internal" href="preprocessing.html#valis.preprocessing.ImageProcesser" title="valis.preprocessing.ImageProcesser"><em>preprocessing.ImageProcesser</em></a>) – preprocessing.ImageProcesser used to pre-process immunofluorescent images
to make them look as similar as possible.</p></li>
<li><p><strong>if_processing_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><em>dict</em></a>) – Dictionary of keyward arguments to be passed to <cite>if_processing_cls</cite></p></li>
<li><p><strong>reader_cls</strong> (<a class="reference internal" href="slide_io.html#valis.slide_io.SlideReader" title="valis.slide_io.SlideReader"><em>SlideReader</em></a><em>, </em><em>optional</em>) – Uninstantiated SlideReader class that will convert
the slide to an image, and also collect metadata. If None (the default),
the appropriate SlideReader will be found by <cite>slide_io.get_slide_reader</cite>.
This option is provided in case the slides cannot be opened by a current
SlideReader class. In this case, the user should create a subclass of
SlideReader. See slide_io.SlideReader for details.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul>
<li><p><strong>rigid_registrar</strong> (<em>SerialRigidRegistrar</em>) – SerialRigidRegistrar object that performed the rigid registration.
This object can be pickled if so desired</p></li>
<li><p><strong>non_rigid_registrar</strong> (<em>SerialNonRigidRegistrar</em>) – SerialNonRigidRegistrar object that performed serial
non-rigid registration. This object can be pickled if so desired.</p></li>
<li><p><strong>summary_df</strong> (<em>Dataframe</em>) – <cite>summary_df</cite> contains various information about the registration.</p>
<p>The “from” column is the name of the image, while the “to” column
name of the image it was aligned to. “from” is analagous to “moving”
or “current”, while “to” is analgous to “fixed” or “previous”.</p>
<p>Columns begining with “original” refer to error measurements of the
unregistered images. Those beginning with “rigid” or “non_rigid” refer
to measurements related to rigid or non-rigid registration, respectively.</p>
<p>Columns beginning with “mean” are averages of error measurements. In
the case of errors based on feature distances (i.e. those ending in “D”),
the mean is weighted by the number of feature matches between “from” and “to”.</p>
<p>Columns endining in “D” indicate the median distance between matched
features in “from” and “to”.</p>
<p>Columns ending in “TRE” indicate the target registration error between
“from” and “to”.</p>
<p>Columns ending in “mattesMI” contain measurements of the Mattes mutual
information between “from” and “to”.</p>
<p>”processed_img_shape” indicates the shape (row, column) of the processed
image actually used to conduct the registration</p>
<p>”shape” is the shape of the slide at full resolution</p>
<p>”aligned_shape” is the shape of the registered full resolution slide</p>
<p>”physical_units” are the names of the pixels physcial unit, e.g. u’µm’</p>
<p>”resolution” is the physical unit per pixel</p>
<p>”name” is the name assigned to the Valis instance</p>
<p>”rigid_time_minutes” is the total number of minutes it took
to convert the images and then rigidly align them.</p>
<p>”non_rigid_time_minutes” is the total number of minutes it took
to convert the images, and then perform rigid -&gt; non-rigid registration.</p>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="valis.registration.Valis.warp_and_merge_slides">
<span class="sig-name descname"><span class="pre">warp_and_merge_slides</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dst_f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_rigid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_name_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_f_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">perceputally_uniform_channel_colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_duplicates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tile_wh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bicubic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compression</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lzw'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/valis/registration.html#Valis.warp_and_merge_slides"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#valis.registration.Valis.warp_and_merge_slides" title="Permalink to this definition">¶</a></dt>
<dd><p>Warp and merge registered slides</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dst_f</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – Path to were the warped slide will be saved. If None, then the slides will be merged
but not saved.</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – Pyramid level to be warped. Default is 0, which means the highest
resolution image will be warped and saved.</p></li>
<li><p><strong>non_rigid</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether or not to conduct non-rigid warping. If False,
then only a rigid transformation will be applied. Default is True</p></li>
<li><p><strong>crop</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – How to crop the registered images. If <cite>True</cite>, then the same crop used
when initializing the <cite>Valis</cite> object will be used. If <cite>False</cite>, the
image will not be cropped. If “overlap”, the warped slide will be
cropped to include only areas where all images overlapped.
“reference” crops to the area that overlaps with the reference image,
defined by <cite>reference_img_f</cite> when initialzing the <cite>Valis object</cite>.</p></li>
<li><p><strong>channel_name_dict</strong> (<em>dict of lists</em><em>, </em><em>optional.</em>) – key =  slide file name, value = list of channel names for that slide. If None,
the the channel names found in each slide will be used.</p></li>
<li><p><strong>src_f_list</strong> (<em>list of str</em><em>, </em><em>optionaal</em>) – List of paths to slide to be warped. If None (the default), Valis.original_img_list
will be used. Otherwise, the paths to which <cite>src_f_list</cite> points to should
be an alternative copy of the slides, such as ones that have undergone
processing (e.g. stain segmentation), had a mask applied, etc…</p></li>
<li><p><strong>perceputally_uniform_channel_colors</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether or not to add perceptually uniform channel colors.</p></li>
<li><p><strong>drop_duplicates</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether or not to drop duplicate channels that might be found in multiple slides.
For example, if DAPI is in multiple slides, then the only the DAPI channel in the
first slide will be kept.</p></li>
<li><p><strong>tile_wh</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – Tile width and height used to save image</p></li>
<li><p><strong>interp_method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Interpolation method used when warping slide. Default is “bicubic”</p></li>
<li><p><strong>compression</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Compression method used to save ome.tiff . Default is lzw, but can also
be jpeg or jp2k. See pyips for more details.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>merged_slide</strong> (<em>pyvips.Image</em>) – Image with all channels merged. If <cite>drop_duplicates</cite> is True, then this
will only contain unique channels.</p></li>
<li><p><strong>all_channel_names</strong> (<em>list of str</em>) – Name of each channel in the image</p></li>
<li><p><strong>ome_xml</strong> (<em>str</em>) – OME-XML string containing the slide’s metadata</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="slide">
<h3>Slide<a class="headerlink" href="#slide" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="valis.registration.Slide">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">valis.registration.</span></span><span class="sig-name descname"><span class="pre">Slide</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src_f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reader</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/valis/registration.html#Slide"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#valis.registration.Slide" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores registration info and warps slides/points</p>
<p><cite>Slide</cite> is a class that stores registration parameters
and other metadata about a slide. Once registration has been
completed, <cite>Slide</cite> is also able warp the slide and/or points
using the same registration parameters. Warped slides can be saved
as ome.tiff images with valid ome-xml.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Slide.src_f">
<span class="sig-name descname"><span class="pre">src_f</span></span><a class="headerlink" href="#valis.registration.Slide.src_f" title="Permalink to this definition">¶</a></dt>
<dd><p>Path to slide.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Slide.image">
<span class="sig-name descname"><span class="pre">image</span></span><a class="headerlink" href="#valis.registration.Slide.image" title="Permalink to this definition">¶</a></dt>
<dd><p>Image to registered. Taken from a level in the image pyramid.
However, image may be resized to fit within the <cite>max_image_dim_px</cite>
argument specified when creating a <cite>Valis</cite> object.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Slide.val_obj">
<span class="sig-name descname"><span class="pre">val_obj</span></span><a class="headerlink" href="#valis.registration.Slide.val_obj" title="Permalink to this definition">¶</a></dt>
<dd><p>The “parent” object that registers all of the slide.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#valis.registration.Valis" title="valis.registration.Valis">Valis</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Slide.reader">
<span class="sig-name descname"><span class="pre">reader</span></span><a class="headerlink" href="#valis.registration.Slide.reader" title="Permalink to this definition">¶</a></dt>
<dd><p>Object that can read slides and collect metadata.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="slide_io.html#valis.slide_io.SlideReader" title="valis.slide_io.SlideReader">SlideReader</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Slide.original_xml">
<span class="sig-name descname"><span class="pre">original_xml</span></span><a class="headerlink" href="#valis.registration.Slide.original_xml" title="Permalink to this definition">¶</a></dt>
<dd><p>Xml string created by bio-formats</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Slide.img_type">
<span class="sig-name descname"><span class="pre">img_type</span></span><a class="headerlink" href="#valis.registration.Slide.img_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether the image is “brightfield” or “fluorescence”</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Slide.is_rgb">
<span class="sig-name descname"><span class="pre">is_rgb</span></span><a class="headerlink" href="#valis.registration.Slide.is_rgb" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether or not the slide is RGB.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Slide.slide_shape_rc">
<span class="sig-name descname"><span class="pre">slide_shape_rc</span></span><a class="headerlink" href="#valis.registration.Slide.slide_shape_rc" title="Permalink to this definition">¶</a></dt>
<dd><p>Dimensions of the largest resolution in the slide, in the form
of (row, col).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>tuple of int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Slide.series">
<span class="sig-name descname"><span class="pre">series</span></span><a class="headerlink" href="#valis.registration.Slide.series" title="Permalink to this definition">¶</a></dt>
<dd><p>Slide series to be read</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Slide.slide_dimensions_wh">
<span class="sig-name descname"><span class="pre">slide_dimensions_wh</span></span><a class="headerlink" href="#valis.registration.Slide.slide_dimensions_wh" title="Permalink to this definition">¶</a></dt>
<dd><p>Dimensions of all images in the pyramid (width, height).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Slide.resolution">
<span class="sig-name descname"><span class="pre">resolution</span></span><a class="headerlink" href="#valis.registration.Slide.resolution" title="Permalink to this definition">¶</a></dt>
<dd><p>Physical size of each pixel.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Slide.units">
<span class="sig-name descname"><span class="pre">units</span></span><a class="headerlink" href="#valis.registration.Slide.units" title="Permalink to this definition">¶</a></dt>
<dd><p>Physical unit of each pixel.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Slide.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#valis.registration.Slide.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the image. Usually <cite>img_f</cite> but with the extension removed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Slide.processed_img">
<span class="sig-name descname"><span class="pre">processed_img</span></span><a class="headerlink" href="#valis.registration.Slide.processed_img" title="Permalink to this definition">¶</a></dt>
<dd><p>Image used to perform registration</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Slide.rigid_reg_mask">
<span class="sig-name descname"><span class="pre">rigid_reg_mask</span></span><a class="headerlink" href="#valis.registration.Slide.rigid_reg_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Mask of convex hulls covering tissue in unregistered image.
Could be used to mask <cite>processed_img</cite> before rigid registration</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Slide.non_rigid_reg_mask">
<span class="sig-name descname"><span class="pre">non_rigid_reg_mask</span></span><a class="headerlink" href="#valis.registration.Slide.non_rigid_reg_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Created by combining rigidly warped <cite>rigid_reg_mask</cite> in all
other slides.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Slide.stack_idx">
<span class="sig-name descname"><span class="pre">stack_idx</span></span><a class="headerlink" href="#valis.registration.Slide.stack_idx" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of image in sorted Z-stack</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Slide.processed_img_f">
<span class="sig-name descname"><span class="pre">processed_img_f</span></span><a class="headerlink" href="#valis.registration.Slide.processed_img_f" title="Permalink to this definition">¶</a></dt>
<dd><p>Path to thumbnail of the processed <cite>image</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Slide.rigid_reg_img_f">
<span class="sig-name descname"><span class="pre">rigid_reg_img_f</span></span><a class="headerlink" href="#valis.registration.Slide.rigid_reg_img_f" title="Permalink to this definition">¶</a></dt>
<dd><p>Path to thumbnail of rigidly aligned <cite>image</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Slide.non_rigid_reg_img_f">
<span class="sig-name descname"><span class="pre">non_rigid_reg_img_f</span></span><a class="headerlink" href="#valis.registration.Slide.non_rigid_reg_img_f" title="Permalink to this definition">¶</a></dt>
<dd><p>Path to thumbnail of non-rigidly aligned <cite>image</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Slide.processed_img_shape_rc">
<span class="sig-name descname"><span class="pre">processed_img_shape_rc</span></span><a class="headerlink" href="#valis.registration.Slide.processed_img_shape_rc" title="Permalink to this definition">¶</a></dt>
<dd><p>Shape (row, col) of the processed image used to find the
transformation parameters. Maximum dimension will be less or
equal to the <cite>max_processed_image_dim_px</cite> specified when
creating a <cite>Valis</cite> object. As such, this may be smaller than
the image’s shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>tuple of int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Slide.aligned_slide_shape_rc">
<span class="sig-name descname"><span class="pre">aligned_slide_shape_rc</span></span><a class="headerlink" href="#valis.registration.Slide.aligned_slide_shape_rc" title="Permalink to this definition">¶</a></dt>
<dd><p>Shape (row, col) of aligned slide, based on the dimensions in the 0th
level of they pyramid. In</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>tuple of int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Slide.reg_img_shape_rc">
<span class="sig-name descname"><span class="pre">reg_img_shape_rc</span></span><a class="headerlink" href="#valis.registration.Slide.reg_img_shape_rc" title="Permalink to this definition">¶</a></dt>
<dd><p>Shape (row, col) of the registered image</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>tuple of int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Slide.M">
<span class="sig-name descname"><span class="pre">M</span></span><a class="headerlink" href="#valis.registration.Slide.M" title="Permalink to this definition">¶</a></dt>
<dd><p>Rigid transformation matrix that aligns <cite>image</cite> to the previous
image in the stack. Found using the processed copy of <cite>image</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Slide.bk_dxdy">
<span class="sig-name descname"><span class="pre">bk_dxdy</span></span><a class="headerlink" href="#valis.registration.Slide.bk_dxdy" title="Permalink to this definition">¶</a></dt>
<dd><p>(2, N, M) numpy array of pixel displacements in
the x and y directions. dx = bk_dxdy[0], and dy=bk_dxdy[1]. Used
to warp images. Found using the rigidly aligned version of the
processed image.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Slide.fwd_dxdy">
<span class="sig-name descname"><span class="pre">fwd_dxdy</span></span><a class="headerlink" href="#valis.registration.Slide.fwd_dxdy" title="Permalink to this definition">¶</a></dt>
<dd><p>Inverse of <cite>bk_dxdy</cite>. Used to warp points.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Slide._bk_dxdy_f">
<span class="sig-name descname"><span class="pre">_bk_dxdy_f</span></span><a class="headerlink" href="#valis.registration.Slide._bk_dxdy_f" title="Permalink to this definition">¶</a></dt>
<dd><p>Path to file containing bk_dxdy, if saved</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Slide._fwd_dxdy_f">
<span class="sig-name descname"><span class="pre">_fwd_dxdy_f</span></span><a class="headerlink" href="#valis.registration.Slide._fwd_dxdy_f" title="Permalink to this definition">¶</a></dt>
<dd><p>Path to file containing fwd_dxdy, if saved</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Slide._bk_dxdy_np">
<span class="sig-name descname"><span class="pre">_bk_dxdy_np</span></span><a class="headerlink" href="#valis.registration.Slide._bk_dxdy_np" title="Permalink to this definition">¶</a></dt>
<dd><p><cite>bk_dxdy</cite> as a numpy array. Only not None if <cite>bk_dxdy</cite> becomes
associated with a file</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Slide._fwd_dxdy_np">
<span class="sig-name descname"><span class="pre">_fwd_dxdy_np</span></span><a class="headerlink" href="#valis.registration.Slide._fwd_dxdy_np" title="Permalink to this definition">¶</a></dt>
<dd><p><cite>fwd_dxdy</cite> as a numpy array. Only not None if <cite>fwd_dxdy</cite> becomes
associated with a file</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Slide.stored_dxdy">
<span class="sig-name descname"><span class="pre">stored_dxdy</span></span><a class="headerlink" href="#valis.registration.Slide.stored_dxdy" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether or not the non-rigid displacements are saved in a file
Should only occur if image is very large.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Slide.fixed_slide">
<span class="sig-name descname"><span class="pre">fixed_slide</span></span><a class="headerlink" href="#valis.registration.Slide.fixed_slide" title="Permalink to this definition">¶</a></dt>
<dd><p>Slide object to which this one was aligned.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#valis.registration.Slide" title="valis.registration.Slide">Slide</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Slide.xy_matched_to_prev">
<span class="sig-name descname"><span class="pre">xy_matched_to_prev</span></span><a class="headerlink" href="#valis.registration.Slide.xy_matched_to_prev" title="Permalink to this definition">¶</a></dt>
<dd><p>Coordinates (x, y) of features in <cite>image</cite> that had matches in the
previous image. Will have shape (N, 2)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Slide.xy_in_prev">
<span class="sig-name descname"><span class="pre">xy_in_prev</span></span><a class="headerlink" href="#valis.registration.Slide.xy_in_prev" title="Permalink to this definition">¶</a></dt>
<dd><p>Coordinates (x, y) of features in the previous that had matches
to those in <cite>image</cite>. Will have shape (N, 2)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Slide.xy_matched_to_prev_in_bbox">
<span class="sig-name descname"><span class="pre">xy_matched_to_prev_in_bbox</span></span><a class="headerlink" href="#valis.registration.Slide.xy_matched_to_prev_in_bbox" title="Permalink to this definition">¶</a></dt>
<dd><p>Subset of <cite>xy_matched_to_prev</cite> that were within <cite>overlap_mask_bbox_xywh</cite>.
Will either have shape (N, 2) or (M, 2), with M &lt; N.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Slide.xy_in_prev_in_bbox">
<span class="sig-name descname"><span class="pre">xy_in_prev_in_bbox</span></span><a class="headerlink" href="#valis.registration.Slide.xy_in_prev_in_bbox" title="Permalink to this definition">¶</a></dt>
<dd><p>Subset of <cite>xy_in_prev</cite> that were within <cite>overlap_mask_bbox_xywh</cite>.
Will either have shape (N, 2) or (M, 2), with M &lt; N.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Slide.crop">
<span class="sig-name descname"><span class="pre">crop</span></span><a class="headerlink" href="#valis.registration.Slide.crop" title="Permalink to this definition">¶</a></dt>
<dd><p>Crop method</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Slide.bg_px_pos_rc">
<span class="sig-name descname"><span class="pre">bg_px_pos_rc</span></span><a class="headerlink" href="#valis.registration.Slide.bg_px_pos_rc" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of pixel that has the background color</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.registration.Slide.bg_color">
<span class="sig-name descname"><span class="pre">bg_color</span></span><a class="headerlink" href="#valis.registration.Slide.bg_color" title="Permalink to this definition">¶</a></dt>
<dd><p>Color of background pixels</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a>, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="valis.registration.Slide.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src_f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reader</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/valis/registration.html#Slide.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#valis.registration.Slide.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>src_f</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Path to slide.</p></li>
<li><p><strong>image</strong> (<em>ndarray</em>) – Image to registered. Taken from a level in the image pyramid.
However, image may be resized to fit within the <cite>max_image_dim_px</cite>
argument specified when creating a <cite>Valis</cite> object.</p></li>
<li><p><strong>val_obj</strong> (<a class="reference internal" href="#valis.registration.Valis" title="valis.registration.Valis"><em>Valis</em></a>) – The “parent” object that registers all of the slide.</p></li>
<li><p><strong>reader</strong> (<a class="reference internal" href="slide_io.html#valis.slide_io.SlideReader" title="valis.slide_io.SlideReader"><em>SlideReader</em></a>) – Object that can read slides and collect metadata.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="valis.registration.Slide.slide2image">
<span class="sig-name descname"><span class="pre">slide2image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">level</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">series</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xywh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/valis/registration.html#Slide.slide2image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#valis.registration.Slide.slide2image" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert slide to image</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – Pyramid level</p></li>
<li><p><strong>series</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – Series number. Defaults to 0</p></li>
<li><p><strong>xywh</strong> (<em>tuple of int</em><em>, </em><em>optional</em>) – The region to be sliced from the slide. If None,
then the entire slide will be converted. Otherwise
xywh is the (top left x, top left y, width, height) of
the region to be sliced.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>img</strong> – An image of the slide or the region defined by xywh</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="valis.registration.Slide.slide2vips">
<span class="sig-name descname"><span class="pre">slide2vips</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">level</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">series</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xywh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/valis/registration.html#Slide.slide2vips"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#valis.registration.Slide.slide2vips" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert slide to pyvips.Image</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – Pyramid level</p></li>
<li><p><strong>series</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – Series number. Defaults to 0</p></li>
<li><p><strong>xywh</strong> (<em>tuple of int</em><em>, </em><em>optional</em>) – The region to be sliced from the slide. If None,
then the entire slide will be converted. Otherwise
xywh is the (top left x, top left y, width, height) of
the region to be sliced.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>vips_slide</strong> – An of the slide or the region defined by xywh</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pyvips.Image</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="valis.registration.Slide.warp_and_save_slide">
<span class="sig-name descname"><span class="pre">warp_and_save_slide</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dst_f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_rigid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">perceputally_uniform_channel_colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bicubic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tile_wh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compression</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lzw'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/valis/registration.html#Slide.warp_and_save_slide"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#valis.registration.Slide.warp_and_save_slide" title="Permalink to this definition">¶</a></dt>
<dd><p>Warp and save a slide</p>
<p>Slides will be saved in the ome.tiff format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dst_f</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Path to were the warped slide will be saved.</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – Pyramid level to be warped</p></li>
<li><p><strong>non_rigid</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether or not to conduct non-rigid warping. If False,
then only a rigid transformation will be applied. Default is True</p></li>
<li><p><strong>crop</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – How to crop the registered images. If <cite>True</cite>, then the same crop used
when initializing the <cite>Valis</cite> object will be used. If <cite>False</cite>, the
image will not be cropped. If “overlap”, the warped slide will be
cropped to include only areas where all images overlapped.
“reference” crops to the area that overlaps with the reference image,
defined by <cite>reference_img_f</cite> when initialzing the <cite>Valis object</cite>.</p></li>
<li><p><strong>channel_names</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a><em>, </em><em>optional</em>) – List of channel names. If None, then Slide.reader
will attempt to find the channel names associated with <cite>src_f</cite>.</p></li>
<li><p><strong>src_f</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – Path of slide to be warped. If None (the deffault), Slide.src_f
will be used. Otherwise, the file to which <cite>src_f</cite> points to should
be an alternative copy of the slide, such as one that has undergone
processing (e.g. stain segmentation), has a mask applied, etc…</p></li>
<li><p><strong>interp_method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Interpolation method used when warping slide. Default is “bicubic”</p></li>
<li><p><strong>tile_wh</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><em>optional</em>) – Tile width and height used to save image</p></li>
<li><p><strong>compression</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Compression method used to save ome.tiff . Default is lzw, but can also
be jpeg or jp2k. See pyips for more details.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="valis.registration.Slide.warp_img">
<span class="sig-name descname"><span class="pre">warp_img</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_rigid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bicubic'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/valis/registration.html#Slide.warp_img"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#valis.registration.Slide.warp_img" title="Permalink to this definition">¶</a></dt>
<dd><p>Warp an image using the registration parameters</p>
<dl class="simple">
<dt>img<span class="classifier">ndarray, optional</span></dt><dd><p>The image to be warped. If None, then Slide.image
will be warped.</p>
</dd>
<dt>non_rigid<span class="classifier">bool</span></dt><dd><p>Whether or not to conduct non-rigid warping. If False,
then only a rigid transformation will be applied.</p>
</dd>
<dt>crop: bool, str</dt><dd><p>How to crop the registered images. If <cite>True</cite>, then the same crop used
when initializing the <cite>Valis</cite> object will be used. If <cite>False</cite>, the
image will not be cropped. If “overlap”, the warped slide will be
cropped to include only areas where all images overlapped.
“reference” crops to the area that overlaps with the reference image,
defined by <cite>reference_img_f</cite> when initialzing the <cite>Valis object</cite>.</p>
</dd>
<dt>interp_method<span class="classifier">str</span></dt><dd><p>Interpolation method used when warping slide. Default is “bicubic”</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>warped_img</strong> – Warped copy of <cite>img</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="valis.registration.Slide.warp_slide">
<span class="sig-name descname"><span class="pre">warp_slide</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">level</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_rigid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bicubic'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/valis/registration.html#Slide.warp_slide"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#valis.registration.Slide.warp_slide" title="Permalink to this definition">¶</a></dt>
<dd><p>Warp a slide using registration parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – Pyramid level to be warped</p></li>
<li><p><strong>non_rigid</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether or not to conduct non-rigid warping. If False,
then only a rigid transformation will be applied. Default is True</p></li>
<li><p><strong>crop</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – How to crop the registered images. If <cite>True</cite>, then the same crop used
when initializing the <cite>Valis</cite> object will be used. If <cite>False</cite>, the
image will not be cropped. If “overlap”, the warped slide will be
cropped to include only areas where all images overlapped.
“reference” crops to the area that overlaps with the reference image,
defined by <cite>reference_img_f</cite> when initialzing the <cite>Valis object</cite>.</p></li>
<li><p><strong>src_f</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – Path of slide to be warped. If None (the default), Slide.src_f
will be used. Otherwise, the file to which <cite>src_f</cite> points to should
be an alternative copy of the slide, such as one that has undergone
processing (e.g. stain segmentation), has a mask applied, etc…</p></li>
<li><p><strong>interp_method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Interpolation method used when warping slide. Default is “bicubic”</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="valis.registration.Slide.warp_xy">
<span class="sig-name descname"><span class="pre">warp_xy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slide_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pt_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_rigid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/valis/registration.html#Slide.warp_xy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#valis.registration.Slide.warp_xy" title="Permalink to this definition">¶</a></dt>
<dd><p>Warp points using registration parameters</p>
<p>Warps <cite>xy</cite> to their location in the registered slide/image</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xy</strong> (<em>ndarray</em>) – (N, 2) array of points to be warped. Must be x,y coordinates</p></li>
<li><p><strong>slide_level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a><em>, </em><em>optional</em>) – Pyramid level of the slide. Used to scale transformation matrices.
Can also be the shape of the warped image (row, col) into which
the points should be warped. Default is 0.</p></li>
<li><p><strong>pt_level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a><em>, </em><em>optional</em>) – Pyramid level from which the points origingated. For example, if
<cite>xy</cite> are from the centroids of cell segmentation performed on the
full resolution image, this should be 0. Alternatively, the value can
be a tuple of the image’s shape (row, col) from which the points came.
For example, if <cite>xy</cite> are  bounding box coordinates from an analysis on
a lower resolution image, then pt_level is that lower resolution
image’s shape (row, col). Default is 0.</p></li>
<li><p><strong>non_rigid</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether or not to conduct non-rigid warping. If False,
then only a rigid transformation will be applied. Default is True.</p></li>
<li><p><strong>crop</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – <p>Apply crop to warped points by shifting points to the mask’s origin.
Note that this can result in negative coordinates, but might be useful
if wanting to draw the coordinates on the registered slide, such as
annotation coordinates.</p>
<p>If <cite>True</cite>, then the same crop used
when initializing the <cite>Valis</cite> object will be used. If <cite>False</cite>, the
image will not be cropped. If “overlap”, the warped slide will be
cropped to include only areas where all images overlapped.
“reference” crops to the area that overlaps with the reference image,
defined by <cite>reference_img_f</cite> when initialzing the <cite>Valis object</cite>.</p>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="valis.registration.Slide.warp_xy_from_to">
<span class="sig-name descname"><span class="pre">warp_xy_from_to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_slide_obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_slide_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_pt_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dst_slide_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_rigid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/valis/registration.html#Slide.warp_xy_from_to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#valis.registration.Slide.warp_xy_from_to" title="Permalink to this definition">¶</a></dt>
<dd><p>Warp points from this slide to another unwarped slide</p>
<p>Takes a set of points found in this unwarped slide, and warps them to
their position in the unwarped “to” slide.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xy</strong> (<em>ndarray</em>) – (N, 2) array of points to be warped. Must be x,y coordinates</p></li>
<li><p><strong>to_slide_obj</strong> (<a class="reference internal" href="#valis.registration.Slide" title="valis.registration.Slide"><em>Slide</em></a>) – Slide to which the points will be warped. I.e. <cite>xy</cite>
will be warped from this Slide to their position in
the unwarped slide associated with <cite>to_slide_obj</cite>.</p></li>
<li><p><strong>src_pt_level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a><em>, </em><em>optional</em>) – Pyramid level of the slide/image in which <cite>xy</cite> originated.
For example, if <cite>xy</cite> are from the centroids of cell segmentation
performed on the unwarped full resolution image, this should be 0.
Alternatively, the value can be a tuple of the image’s shape (row, col)
from which the points came. For example, if <cite>xy</cite> are  bounding
box coordinates from an analysis on a lower resolution image,
then pt_level is that lower resolution image’s shape (row, col).</p></li>
<li><p><strong>dst_slide_level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><em>tuple</em></a><em>, </em><em>optional</em>) – Pyramid level of the slide/image in to <cite>xy</cite> will be warped.
Similar to <cite>src_pt_level</cite>, if <cite>dst_slide_level</cite> is an int then
the points will be warped to that pyramid level. If <cite>dst_slide_level</cite>
is the “to” image’s shape (row, col), then the points will be warped
to their location in an image with that same shape.</p></li>
<li><p><strong>non_rigid</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether or not to conduct non-rigid warping. If False,
then only a rigid transformation will be applied.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
</section>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="slide_io.html" class="btn btn-neutral float-right" title="Slide I/O" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="index.html" class="btn btn-neutral float-left" title="VALIS" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2022, Chandler Gatenbee.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>