

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Serial rigid registration &mdash; valis &#34;1.0.0rc11&#34;
 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Serial non-rigid registration" href="serial_non_rigid.html" />
    <link rel="prev" title="Non-rigid registration" href="non_rigid_registrars.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: black" >
          

          
            <a href="index.html">
          

          
            
            <img src="_static/valis_logo_black_no_bg.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="registration.html">Registration</a></li>
<li class="toctree-l1"><a class="reference internal" href="slide_io.html">Slide I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="preprocessing.html">Image pre-processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="feature_detectors.html">Feature detectors and descriptors</a></li>
<li class="toctree-l1"><a class="reference internal" href="feature_matcher.html">Feature matching</a></li>
<li class="toctree-l1"><a class="reference internal" href="affine_optimizer.html">Affine optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="non_rigid_registrars.html">Non-rigid registration</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Serial rigid registration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-valis.serial_rigid">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#classes">Classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#zimage">ZImage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#serialrigidregistrar">SerialRigidRegistrar</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="serial_non_rigid.html">Serial non-rigid registration</a></li>
<li class="toctree-l1"><a class="reference internal" href="viz.html">Visualization</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">valis</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Serial rigid registration</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/serial_rigid.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="serial-rigid-registration">
<h1>Serial rigid registration<a class="headerlink" href="#serial-rigid-registration" title="Permalink to this headline">¶</a></h1>
<section id="module-valis.serial_rigid">
<span id="functions"></span><h2>Functions<a class="headerlink" href="#module-valis.serial_rigid" title="Permalink to this headline">¶</a></h2>
<p>Classes and functions to perform serial rigid registration of a set of images</p>
<dl class="py function">
<dt class="sig sig-object py" id="valis.serial_rigid.register_images">
<span class="sig-prename descclassname"><span class="pre">valis.serial_rigid.</span></span><span class="sig-name descname"><span class="pre">register_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">img_dir,</span> <span class="pre">dst_dir=None,</span> <span class="pre">name='registrar',</span> <span class="pre">feature_detector=&lt;valis.feature_detectors.VggFD</span> <span class="pre">object&gt;,</span> <span class="pre">matcher=&lt;valis.feature_matcher.Matcher</span> <span class="pre">object&gt;,</span> <span class="pre">transformer=&lt;EuclideanTransform(matrix=</span>&#160;&#160;&#160;&#160; <span class="pre">[[</span> <span class="pre">1.,</span>&#160; <span class="pre">0.,</span>&#160; <span class="pre">0.],</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">[</span> <span class="pre">0.,</span>&#160; <span class="pre">1.,</span>&#160; <span class="pre">0.],</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">[</span> <span class="pre">0.,</span>&#160; <span class="pre">0.,</span>&#160; <span class="pre">1.]])&gt;,</span> <span class="pre">affine_optimizer=None,</span> <span class="pre">imgs_ordered=False,</span> <span class="pre">reference_img_f=None,</span> <span class="pre">similarity_metric='n_matches',</span> <span class="pre">max_scaling=3.0,</span> <span class="pre">align_to_reference=False,</span> <span class="pre">qt_emitter=None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/valis/serial_rigid.html#register_images"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#valis.serial_rigid.register_images" title="Permalink to this definition">¶</a></dt>
<dd><p>Rigidly align collection of images</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Path to directory containing the images that the user would like
to be registered. These images need to be single channel, uint8 images</p></li>
<li><p><strong>dst_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – Top directory where aliged images should be save. SerialRigidRegistrar will
be in this folder, and aligned images in the “registered_images”
sub-directory. If None, the images will not be written to file</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – Descriptive name of registrar, such as the sample’s name</p></li>
<li><p><strong>feature_detector</strong> (<a class="reference internal" href="feature_detectors.html#valis.feature_detectors.FeatureDD" title="valis.feature_detectors.FeatureDD"><em>FeatureDD</em></a>) – FeatureDD object that detects and computes image features.</p></li>
<li><p><strong>matcher</strong> (<a class="reference internal" href="feature_matcher.html#valis.feature_matcher.Matcher" title="valis.feature_matcher.Matcher"><em>Matcher</em></a>) – Matcher object that will be used to match image features</p></li>
<li><p><strong>transformer</strong> (<em>scikit-image Transform object</em>) – Transformer used to find transformation matrix that will warp each
image to the target image.</p></li>
<li><p><strong>affine_optimizer</strong> (<em>AffineOptimzer object</em>) – Object that will minimize a cost function to find the
optimal affine transoformations</p></li>
<li><p><strong>imgs_ordered</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – Boolean defining whether or not the order of images in img_dir
are already in the correct order. If True, then each filename should
begin with the number that indicates its position in the z-stack. If
False, then the images will be sorted by ordering a feature distance
matix.</p></li>
<li><p><strong>reference_img_f</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – Filename of image that will be treated as the center of the stack.
If None, the index of the middle image will be the reference.</p></li>
<li><p><strong>similarity_metric</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Metric used to calculate similarity between images, which is in turn
used to build the distance matrix used to sort the images.</p></li>
<li><p><strong>summary</strong> (<em>Dataframe</em>) – Pandas dataframe containing the median distance between matched features
before and after registration.</p></li>
<li><p><strong>align_to_reference</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether or not images should be aligned to a reference image
specified by <cite>reference_img_f</cite>.</p></li>
<li><p><strong>qt_emitter</strong> (<em>PySide2.QtCore.Signal</em><em>, </em><em>optional</em>) – Used to emit signals that update the GUI’s progress bars</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>registrar</strong> – SerialRigidRegistrar object contains general information about the alginments,
but also a list of Z-images. Each ZImage contains the warp information
for an image in the stack, including the transformation matrices
calculated at each step, keypoint poisions, image descriptors, and
matches with other images. See attributes from Zimage for more
information.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#valis.serial_rigid.SerialRigidRegistrar" title="valis.serial_rigid.SerialRigidRegistrar">SerialRigidRegistrar</a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h2>
<section id="zimage">
<h3>ZImage<a class="headerlink" href="#zimage" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="valis.serial_rigid.ZImage">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">valis.serial_rigid.</span></span><span class="sig-name descname"><span class="pre">ZImage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/valis/serial_rigid.html#ZImage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#valis.serial_rigid.ZImage" title="Permalink to this definition">¶</a></dt>
<dd><p>Class store info about an image, including the rigid registration parameters</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="valis.serial_rigid.ZImage.image">
<span class="sig-name descname"><span class="pre">image</span></span><a class="headerlink" href="#valis.serial_rigid.ZImage.image" title="Permalink to this definition">¶</a></dt>
<dd><p>Greyscale image that will be used for feature detection. This images
should be greyscale and may need to have undergone preprocessing to
make them look as similar as possible.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.serial_rigid.ZImage.full_img_f">
<span class="sig-name descname"><span class="pre">full_img_f</span></span><a class="headerlink" href="#valis.serial_rigid.ZImage.full_img_f" title="Permalink to this definition">¶</a></dt>
<dd><p>full path to the image</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.serial_rigid.ZImage.img_id">
<span class="sig-name descname"><span class="pre">img_id</span></span><a class="headerlink" href="#valis.serial_rigid.ZImage.img_id" title="Permalink to this definition">¶</a></dt>
<dd><p>ID of the image, based on its ordering <cite>processed_src_dir</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.serial_rigid.ZImage.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#valis.serial_rigid.ZImage.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the image. Usually <cite>img_f</cite> but with the extension removed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.serial_rigid.ZImage.desc">
<span class="sig-name descname"><span class="pre">desc</span></span><a class="headerlink" href="#valis.serial_rigid.ZImage.desc" title="Permalink to this definition">¶</a></dt>
<dd><p>(N, M) array of N desciptors for each keypoint, each of which has
M features</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.serial_rigid.ZImage.kp_pos_xy">
<span class="sig-name descname"><span class="pre">kp_pos_xy</span></span><a class="headerlink" href="#valis.serial_rigid.ZImage.kp_pos_xy" title="Permalink to this definition">¶</a></dt>
<dd><p>(N, 2) array of position for each keypoint</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.serial_rigid.ZImage.match_dict">
<span class="sig-name descname"><span class="pre">match_dict</span></span><a class="headerlink" href="#valis.serial_rigid.ZImage.match_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of image matches. Key= img_obj this ZImage is being
compared to, value= MatchInfo containing information about the
comparison, such as the position of matches, features for each match,
number of matches, etc… The MatchInfo objects in this dictionary
contain only the info for matches that were considered “good”.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.serial_rigid.ZImage.unfiltered_match_dict">
<span class="sig-name descname"><span class="pre">unfiltered_match_dict</span></span><a class="headerlink" href="#valis.serial_rigid.ZImage.unfiltered_match_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of image matches. Key= img_obj this ZImage is being
compared to, value= MatchInfo containing inoformation about the
comparison, such as the position of matches, features for each match,
number of matches, etc… The MatchInfo objects in this dictionary
contain info for all matches that were cross-checked.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.serial_rigid.ZImage.stack_idx">
<span class="sig-name descname"><span class="pre">stack_idx</span></span><a class="headerlink" href="#valis.serial_rigid.ZImage.stack_idx" title="Permalink to this definition">¶</a></dt>
<dd><p>Position of image in sorted Z-stack</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.serial_rigid.ZImage.fixed_obj">
<span class="sig-name descname"><span class="pre">fixed_obj</span></span><a class="headerlink" href="#valis.serial_rigid.ZImage.fixed_obj" title="Permalink to this definition">¶</a></dt>
<dd><p>ZImage to which this ZImage was aligned, i.e. this is the “moving”
image, and <cite>fixed_obj</cite> is the “fixed” image. This is set during
the <cite>align_to_prev</cite> method of the SerialRigidRegistrar. The
<cite>fixed_obj</cite> will either be immediately above or immediately
below this ZImage in the image stack.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#valis.serial_rigid.ZImage" title="valis.serial_rigid.ZImage">ZImage</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.serial_rigid.ZImage.T">
<span class="sig-name descname"><span class="pre">T</span></span><a class="headerlink" href="#valis.serial_rigid.ZImage.T" title="Permalink to this definition">¶</a></dt>
<dd><p>Transformation matrix that translates the image such that it is in a
padded image that has the same shape as all other images</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.serial_rigid.ZImage.to_prev_A">
<span class="sig-name descname"><span class="pre">to_prev_A</span></span><a class="headerlink" href="#valis.serial_rigid.ZImage.to_prev_A" title="Permalink to this definition">¶</a></dt>
<dd><p>Transformation matrix that warps image to align with the previous image</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.serial_rigid.ZImage.optimal_M">
<span class="sig-name descname"><span class="pre">optimal_M</span></span><a class="headerlink" href="#valis.serial_rigid.ZImage.optimal_M" title="Permalink to this definition">¶</a></dt>
<dd><p>Transformation matrix found by minimizing a cost function.
Used as final optional step to refine alignment</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.serial_rigid.ZImage.crop_T">
<span class="sig-name descname"><span class="pre">crop_T</span></span><a class="headerlink" href="#valis.serial_rigid.ZImage.crop_T" title="Permalink to this definition">¶</a></dt>
<dd><p>Transformation matrix used to crop image after registration</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.serial_rigid.ZImage.M">
<span class="sig-name descname"><span class="pre">M</span></span><a class="headerlink" href="#valis.serial_rigid.ZImage.M" title="Permalink to this definition">¶</a></dt>
<dd><p>Final transformation matrix that aligns image in the Z-stack.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.serial_rigid.ZImage.M_inv">
<span class="sig-name descname"><span class="pre">M_inv</span></span><a class="headerlink" href="#valis.serial_rigid.ZImage.M_inv" title="Permalink to this definition">¶</a></dt>
<dd><p>Inverse of final transformation matrix that aligns image in
the Z-stack.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.serial_rigid.ZImage.registered_img">
<span class="sig-name descname"><span class="pre">registered_img</span></span><a class="headerlink" href="#valis.serial_rigid.ZImage.registered_img" title="Permalink to this definition">¶</a></dt>
<dd><p>image after being warped</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.serial_rigid.ZImage.padded_shape_rc">
<span class="sig-name descname"><span class="pre">padded_shape_rc</span></span><a class="headerlink" href="#valis.serial_rigid.ZImage.padded_shape_rc" title="Permalink to this definition">¶</a></dt>
<dd><p>Shape of padded image. All other images will have this shape</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">registered_shape_rc</span> <span class="pre">=</span> <span class="pre">tuple</span></span></dt>
<dd><p>Shape of aligned image. All other aligned images will have this shape</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="valis.serial_rigid.ZImage.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/valis/serial_rigid.html#ZImage.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#valis.serial_rigid.ZImage.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Class that stores information about an image</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>ndarray</em>) – Greyscale image that will be used for feature detection. This
images should be single channel uint8 images, and may need to
have undergone preprocessing and/or normalization to make them
look as similar as possible.</p></li>
<li><p><strong>img_f</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – full path to <cite>image</cite></p></li>
<li><p><strong>img_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – ID of the image, based on its ordering in the image source directory</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Name of the image. Usually img_f but with the extension removed.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="serialrigidregistrar">
<h3>SerialRigidRegistrar<a class="headerlink" href="#serialrigidregistrar" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="valis.serial_rigid.SerialRigidRegistrar">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">valis.serial_rigid.</span></span><span class="sig-name descname"><span class="pre">SerialRigidRegistrar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imgs_ordered</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_img_f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align_to_reference</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/valis/serial_rigid.html#SerialRigidRegistrar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#valis.serial_rigid.SerialRigidRegistrar" title="Permalink to this definition">¶</a></dt>
<dd><p>Class that performs serial rigid registration</p>
<p>Registration is conducted by first detecting features in all images.
Features are then matched between images, which are then used to construct
a distance matrix, D. D is then sorted such that the most similar images
are adjcent to one another. The rigid transformation matrics are then found to
align each image with the previous image. Optionally, optimization can be
performed to improve the alignments, although the “optimized” matrix will be
discarded if it increases the distances between matched features.</p>
<p>SerialRigidRegistrar creates a list and dictionary of ZImage objects,
each of which contains information related to feature matching and
the rigid registration matrices.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="valis.serial_rigid.SerialRigidRegistrar.img_dir">
<span class="sig-name descname"><span class="pre">img_dir</span></span><a class="headerlink" href="#valis.serial_rigid.SerialRigidRegistrar.img_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Path to directory containing the images that will be registered.
The images in this folder should be single channel uint8 images.
For the best registration results, they have undergone some sort
of pre-processing and normalization. The preprocessing module
contains methods for this, but the user may want/need to use other
methods.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.serial_rigid.SerialRigidRegistrar.aleady_sorted">
<span class="sig-name descname"><span class="pre">aleady_sorted</span></span><a class="headerlink" href="#valis.serial_rigid.SerialRigidRegistrar.aleady_sorted" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether or not the order of images already known. If True, the file
names should start with ascending numbers, with the first image file
having the smallest number, and the last image file having the largest
number. If False (the default), the order of images will be determined
by ordering a distance matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">bool</a>, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.serial_rigid.SerialRigidRegistrar.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#valis.serial_rigid.SerialRigidRegistrar.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Descriptive name of registrar, such as the sample’s name</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.serial_rigid.SerialRigidRegistrar.img_file_list">
<span class="sig-name descname"><span class="pre">img_file_list</span></span><a class="headerlink" href="#valis.serial_rigid.SerialRigidRegistrar.img_file_list" title="Permalink to this definition">¶</a></dt>
<dd><p>List of full paths to single channel uint8 images</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.serial_rigid.SerialRigidRegistrar.size">
<span class="sig-name descname"><span class="pre">size</span></span><a class="headerlink" href="#valis.serial_rigid.SerialRigidRegistrar.size" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of images to align</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.serial_rigid.SerialRigidRegistrar.distance_metric_name">
<span class="sig-name descname"><span class="pre">distance_metric_name</span></span><a class="headerlink" href="#valis.serial_rigid.SerialRigidRegistrar.distance_metric_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of distance metric used to determine the dis/similarity between
each pair of images</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.serial_rigid.SerialRigidRegistrar.distance_metric_type">
<span class="sig-name descname"><span class="pre">distance_metric_type</span></span><a class="headerlink" href="#valis.serial_rigid.SerialRigidRegistrar.distance_metric_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the type of metric used to determine the dis/similarity
between each pair of images. Despite the name, it could be “similarity”
if the Matcher object compares image feautres using a similarity
metric. In that case, similarities are converted to distances.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.serial_rigid.SerialRigidRegistrar.img_obj_list">
<span class="sig-name descname"><span class="pre">img_obj_list</span></span><a class="headerlink" href="#valis.serial_rigid.SerialRigidRegistrar.img_obj_list" title="Permalink to this definition">¶</a></dt>
<dd><p>List of ZImage objects. Initially unordered, but
eventually be sorted</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.serial_rigid.SerialRigidRegistrar.img_obj_dict">
<span class="sig-name descname"><span class="pre">img_obj_dict</span></span><a class="headerlink" href="#valis.serial_rigid.SerialRigidRegistrar.img_obj_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of ZImage objects. Created to conveniently
access ZIimages. Key = ZImage.name, value= ZImage</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.serial_rigid.SerialRigidRegistrar.optimal_Z">
<span class="sig-name descname"><span class="pre">optimal_Z</span></span><a class="headerlink" href="#valis.serial_rigid.SerialRigidRegistrar.optimal_Z" title="Permalink to this definition">¶</a></dt>
<dd><p>Ordered linkage matrix for <cite>distance_mat</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.serial_rigid.SerialRigidRegistrar.unsorted_distance_mat">
<span class="sig-name descname"><span class="pre">unsorted_distance_mat</span></span><a class="headerlink" href="#valis.serial_rigid.SerialRigidRegistrar.unsorted_distance_mat" title="Permalink to this definition">¶</a></dt>
<dd><p>Distance matrix with shape (N, N), where each element is the
disimilariy betweewn each pair of the N images. The order of
rows and columns reflects the order in which the images were read.
This matrix is used to order the images the Z-stack.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.serial_rigid.SerialRigidRegistrar.distance_mat">
<span class="sig-name descname"><span class="pre">distance_mat</span></span><a class="headerlink" href="#valis.serial_rigid.SerialRigidRegistrar.distance_mat" title="Permalink to this definition">¶</a></dt>
<dd><p><cite>unsorted_distance_mat</cite> reorderd such that the most similar images
are adjacent to one another</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.serial_rigid.SerialRigidRegistrar.unsorted_similarity_mat">
<span class="sig-name descname"><span class="pre">unsorted_similarity_mat</span></span><a class="headerlink" href="#valis.serial_rigid.SerialRigidRegistrar.unsorted_similarity_mat" title="Permalink to this definition">¶</a></dt>
<dd><p>Similar to <cite>unsorted_distance_mat</cite>, except the elements are
image similarity</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.serial_rigid.SerialRigidRegistrar.similarity_mat">
<span class="sig-name descname"><span class="pre">similarity_mat</span></span><a class="headerlink" href="#valis.serial_rigid.SerialRigidRegistrar.similarity_mat" title="Permalink to this definition">¶</a></dt>
<dd><p>Similar to <cite>distance_mat</cite>, except the elements are image similarity</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.serial_rigid.SerialRigidRegistrar.features">
<span class="sig-name descname"><span class="pre">features</span></span><a class="headerlink" href="#valis.serial_rigid.SerialRigidRegistrar.features" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of feature detector and descriptor used</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.serial_rigid.SerialRigidRegistrar.transform_type">
<span class="sig-name descname"><span class="pre">transform_type</span></span><a class="headerlink" href="#valis.serial_rigid.SerialRigidRegistrar.transform_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of scikit-image transformer class that was used</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.serial_rigid.SerialRigidRegistrar.reference_img_f">
<span class="sig-name descname"><span class="pre">reference_img_f</span></span><a class="headerlink" href="#valis.serial_rigid.SerialRigidRegistrar.reference_img_f" title="Permalink to this definition">¶</a></dt>
<dd><p>Filename of image that will be treated as the center of the stack.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.serial_rigid.SerialRigidRegistrar.reference_img_idx">
<span class="sig-name descname"><span class="pre">reference_img_idx</span></span><a class="headerlink" href="#valis.serial_rigid.SerialRigidRegistrar.reference_img_idx" title="Permalink to this definition">¶</a></dt>
<dd><p>Index of ZImage that corresponds to <cite>reference_img_f</cite>, after
the <cite>img_obj_list</cite> has been sorted.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.serial_rigid.SerialRigidRegistrar.align_to_reference">
<span class="sig-name descname"><span class="pre">align_to_reference</span></span><a class="headerlink" href="#valis.serial_rigid.SerialRigidRegistrar.align_to_reference" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether or not images should be aligne to a reference image
specified by <cite>reference_img_f</cite>. Will be set to True if
<cite>reference_img_f</cite> is provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">bool</a>, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.serial_rigid.SerialRigidRegistrar.iter_order">
<span class="sig-name descname"><span class="pre">iter_order</span></span><a class="headerlink" href="#valis.serial_rigid.SerialRigidRegistrar.iter_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Each element of <cite>iter_order</cite> contains a tuple of stack
indices. The first value is the index of the moving/current/from
image, while the second value is the index of the moving/next/to
image.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of tuples</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="valis.serial_rigid.SerialRigidRegistrar.summary_df">
<span class="sig-name descname"><span class="pre">summary_df</span></span><a class="headerlink" href="#valis.serial_rigid.SerialRigidRegistrar.summary_df" title="Permalink to this definition">¶</a></dt>
<dd><p>Pandas dataframe containin the registration error of the
alignment between each image and the previous one in the stack.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="valis.serial_rigid.SerialRigidRegistrar.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imgs_ordered</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_img_f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align_to_reference</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/valis/serial_rigid.html#SerialRigidRegistrar.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#valis.serial_rigid.SerialRigidRegistrar.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Class that performs serial rigid registration</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Path to directory containing the images that will be registered.
The images in this folder should be single channel uint8 images.
For the best registration results, they have undergone some sort
of pre-processing and normalization. The preprocessing module
contains methods for this, but the user may want/need to use other
methods.</p></li>
<li><p><strong>imgs_ordered</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – Whether or not the order of images already known. If True, the file
names should start with ascending numbers, with the first image
file having the smallest number, and the last image file having
the largest number. If False (the default), the order of images
will be determined by sorting a distance matrix.</p></li>
<li><p><strong>reference_img_f</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – Filename of image that will be treated as the center of the stack.
If None, the index of the middle image will be the reference.</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a><em>, </em><em>optional</em>) – Descriptive name of registrar, such as the sample’s name</p></li>
<li><p><strong>align_to_reference</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether or not images should be aligne to a reference image
specified by <cite>reference_img_f</cite>. Will be set to True if
<cite>reference_img_f</cite> is provided.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="valis.serial_rigid.SerialRigidRegistrar.summarize">
<span class="sig-name descname"><span class="pre">summarize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/valis/serial_rigid.html#SerialRigidRegistrar.summarize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#valis.serial_rigid.SerialRigidRegistrar.summarize" title="Permalink to this definition">¶</a></dt>
<dd><p>Summarize alignment error</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>summary_df</strong> – Pandas dataframe containin the registration error of the
alignment between each image and the previous one in the stack.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Dataframe</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
</section>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="serial_non_rigid.html" class="btn btn-neutral float-right" title="Serial non-rigid registration" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="non_rigid_registrars.html" class="btn btn-neutral float-left" title="Non-rigid registration" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2022, Chandler Gatenbee.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>